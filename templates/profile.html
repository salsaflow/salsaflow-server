{{template "header" .}}

<h1>Personal Profile</h1>

<table>
  <tr><td>Name:</td><td>{{.User.Name}}</td><td></td></tr>
  <tr><td>Email:</td><td>{{.User.Email}}</td><td></td></tr>
  <tr><td>API token:</td><td id="token">{{.User.Token}}</td><td><button class="btn btn-primary" onclick="regenerateToken()">Regenerate</button></td></tr>
</table>

<script type="text/javascript">
  var apiURL = window.location.protocol + "//" + window.location.host + {{.PathPrefix}} + "/api/v1";
  console.log(apiURL);
  var userId = {{.User.Id}};

  function regenerateToken() {
    $.get(apiURL + "/users/" + userId + "/generateToken")
      .done(function(data) {
        console.log(data);   
       })
      .fail(function(err) {
        console.error(err)
      });
  }
</script>

{{template "footer" .}}
